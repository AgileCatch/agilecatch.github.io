---
layout: post
title: ì½”í‹€ë¦° ë°°ìš°ê¸°
image: /assets/img/blog/kotlin.png
accent_image: 
  background: url('/assets/img/me/wave3.jpg') center/cover
  overlay: false
accent_color: '#fff'
theme_color: '#fff'
description: >
  kotlin start!
invert_sidebar: true
categories :
 - devlog	
 - android

---

# [TIL] ì„ ë°œëŒ€ 2,3ì£¼ì°¨ ì •ë¦¬

* toc
{:toc}
---

## ì´ë²ˆì£¼ ê³¼ì œ

* `Todo` íƒ­ì´ í™œì„±í™” ë ë•Œë§Œ FABê°€ ë³´ì—¬ì§€ê²Œ ì²˜ë¦¬

- `Todo` íƒ­ì´ ì•„ë‹Œ ê²½ìš° FABì€ ì‚¬ë¼ì ¸ì•¼í•¨
  * ğŸ’¡ ViewPagerì˜ changed ë¦¬ìŠ¤ë„ˆë¥¼ í™œìš©í•´ì„œ, FABì˜ hide()/show()ë¥¼ ì´ìš©í•´ë³´ì„¸ìš”.



* FABë¥¼ ëˆŒëŸ¬ì„œ Todo ì¶”ê°€ í™”ë©´ì„ ë…¸ì¶œ ì‹œí‚¤ê³ , ì œëª©ê³¼ ë‚´ìš©ì„ ì…ë ¥í•´ì„œ `Todo`íƒ­ì— ë°˜ì˜
  * ë ˆì§€ìŠ¤í„°í¬ ì•¡í‹°ë¹„í‹° ë¦¬ì €íŠ¸ë¥¼ ì‚¬ìš©í•´ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ê¸°
  
  

## 1) FAB ë²„íŠ¼ ìˆ¨ê¸°ê¸°

- ë©”ì¸ ì–´ëŒ‘í„°ì—ì„œ í”„ë˜ê·¸ë¨¼íŠ¸ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜ ë§Œë“¤ê¸°

  ```
  fun getFragment(position: Int): Fragment {
      return fragments[position].fragment
  }
  ```

- ë©”ì¸ì—ì„œ **registerOnPageChangeCallback** ì‚¬ìš©í•˜ì—¬ **onPageSelected** í•¨ìˆ˜ ì‚¬ìš©í•˜ê¸°

  ```
  viewPager.registerOnPageChangeCallback(object : ViewPager2.OnPageChangeCallback() {
  
              override fun onPageSelected(position: Int) {
                  //í”„ë˜ê·¸ë¨¼íŠ¸ì˜ í¬ì§€ì…˜ì„ ê°€ì ¸ì™€ ë²„íŠ¼ ë³´ì—¬ì£¼ê³  ìˆ¨ê¸°ê¸°
                  super.onPageSelected(position)
                  //is í‚¤ì›Œë“œ ì‚¬ìš©ìœ¼ë¡œ í”„ë˜ê·¸ë¨¼íŠ¸ í•œì •í•˜ê¸°
                  if (viewPagerAdapter.getFragment(position) is TodoFragment) {
                      fabAddTodo.show()
                  } else {
                      fabAddTodo.hide()
                  }
              }
          })
  ```

  



## 2) FAB í´ë¦­ìœ¼ë¡œ item ì¶”ê°€í•˜ê¸°

* TodoAddActivity ë§Œë“¤ê¸° , ë ˆì´ì•„ì›ƒê¹Œì§€ í•¨ê»˜ ë§Œë“¤ê¸°

  ```
  class TodoAddActivity : AppCompatActivity() {
  
      private lateinit var binding: TodoAddActivityBinding
  
      override fun onCreate(savedInstanceState: Bundle?) {
          super.onCreate(savedInstanceState)
          binding = TodoAddActivityBinding.inflate(layoutInflater)
          setContentView(binding.root)
  
          initView()
      }
  
      private fun initView() = with(binding) {
  
          
      }
  }
  ```

* ë°ì´í„° ë°›ì•„ì˜¤ëŠ” ë¶€ë¶„ ë§Œë“¤ê¸°

  ```
  //ë“±ë¡ ë²„íŠ¼ ëˆŒëŸ¬ intentë¡œ ë°ì´í„° ë°›ì•„ì˜¤ê¸°
          submit.setOnClickListener {
              //scope function applyì‚¬ìš©
              val intent = Intent().apply {
              		//ë°ì´í„° í´ë˜ìŠ¤ë¥¼ ë„˜ê²¨ì£¼ëŠ” ë°©ë²•ì„
                  putExtra(
                      EXTRA_MODEL, TodoModel(
                          todoTitle.text.toString(),
                          todoDescription.text.toString()
                      )
                  )
              }
              setResult(Activity.RESULT_OK, intent)
              finish()
          }
      }
  ```

  * ë°ì´í„° í´ë˜ìŠ¤ë¥¼ ì¸í…íŠ¸ ê°ì²´ë¡œ ë„˜ê¸°ê¸° ìœ„í•´ì„œëŠ” 

  * **gradle> plugins** ì— ë„£ì–´ì¤˜ì•¼í•  ê°’ì´ ìˆìŒ.

    ```
    id 'kotlin-parcelize'
    id 'kotlin-android'
    ```

  * ë°ì´í„° í´ë˜ìŠ¤ì—ì„œ **parcelize**ë¥¼ ìƒì† í•´ì¤˜ì•¼í•¨.

    ```
    @Parcelize
    data class TodoModel(
        val title: String?,
        val description: String?
    ) : Parcelable
    ```

* ì¸í…íŠ¸ë¥¼ ì–»ì„ ìˆ˜ ìˆë„ë¡ í•¨ìˆ˜ ë§Œë“¤ì–´ì£¼ê¸°

  ```
  companion object {
      //ë©”ì¸ ì—‘í‹°ë¹„í‹°ì—ì„œë„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ë³€í•˜ì§€ ì•ŠëŠ” ìƒìˆ˜ê°’ìœ¼ë¡œ ì§€ì •í•´ì¤Œ
      const val EXTRA_MODEL = "extra_model"
  
      fun newIntent(context: Context) = Intent(context, TodoAddActivity::class.java)
  }
  ```

* ë©”ì¸ ì•¡í‹°ë¹„í‹°ë¡œ ëŒì•„ê°€ **registerForActivityResult** ëŸ°ì³ ë§Œë“¤ì–´ì£¼ê¸° (ë²„íŠ¼ì„ ëˆŒë €ì„ë•Œ ì•¡í‹°ë¹„í‹°ì— ëŒ€í•œ ê²°ê³¼ë¥¼ ë°›ì„ ìˆ˜ ìˆìŒ)

  ```
  private val addToDoLauncher =
      registerForActivityResult(ActivityResultContracts.StartActivityForResult()) { result ->
         
      }
  ```

  ```
  private val addToDoLauncher =
      registerForActivityResult(ActivityResultContracts.StartActivityForResult()) { result ->
          if (result.resultCode == Activity.RESULT_OK) {
              val todoModel = if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.TIRAMISU) {
                  result.data?.getParcelableExtra(
                      TodoAddActivity.EXTRA_MODEL,
                      TodoModel::class.java
                  )
              } else {
                  result.data?.getParcelableExtra(
                      TodoAddActivity.EXTRA_MODEL
                  )
              }
  
              val todoFragment = viewPagerAdapter.getFragment(0) as? TodoFragment
              //ì•„ì´í…œ ì¶”ê°€í•˜ê¸°
              todoFragment?.setTodoContent(todoModel)
          }
      }
  ```

* ë²„íŠ¼ ëˆŒë €ì„ë•Œ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ìˆë„ë¡ ì—°ê²°í•´ì£¼ê¸° 

  ```
  // fab
  fabAddTodo.setOnClickListener {
      addToDoLauncher.launch(
          TodoAddActivity.newIntent(this@MainActivity)
      )
  }
  ```


* TodoListAdapterì— ì•„ì´í…œì„ ì¶”ê°€í•  ìˆ˜ ìˆëŠ” í•¨ìˆ˜ ë§Œë“¤ê¸°

  ```
  fun addItem(todoModel: TodoModel?) {
          if (todoModel == null) {
              return
          }
  
          list.add(todoModel)
          //ì „ì²´ ì‚¬ì´ì¦ˆì˜ ì²«ë²ˆì§¸ì— ì¶”ê°€ê°€ ë˜ë„ë¡
          notifyItemChanged(list.size - 1)
      }
  ```

* TodoFragmentì— itemì„ ì¶”ê°€í•  ìˆ˜ ìˆëŠ” í•¨ìˆ˜ ë§Œë“¤ì–´ì£¼ê¸°

	```
	fun setTodoContent(todoModel: TodoModel?) {
  listAdapter.addItem(todoModel)
	}
	```

